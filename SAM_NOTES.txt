-- QUESTION #1
--Display the DEPARTMENT_ID, DEPARTMENT Name 
--and highest salary in each department form Employee Table? 

SELECT E.DEPARTMENT_ID, D.DEPARTMENT_NAME, J.MAX_SALARY FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN JOBS J ON E.JOB_ID = J.JOB_ID;


-- QUESTION # 2
SELECT * FROM HR.EMPLOYEES 
WHERE 
TO_CHAR(HIRE_DATE, 'MON-YYYY') >='JAN-2005' AND TO_CHAR(HIRE_DATE, 'MON-YYYY') <='FEB-2007'
AND
DEPARTMENT_ID NOT IN (50,60)
AND
SALARY > 4500;


-- QUESTION#3 Display unique City and department Name? *
SELECT DISTINCT  CITY AS "NAMES" FROM LOCATIONS
UNION
SELECT DISTINCT DEPARTMENT_NAME "NAMES" FROM DEPARTMENTS;

SELECT DISTINCT  CITY AS "NAMES" FROM LOCATIONS;
SELECT DISTINCT DEPARTMENT_NAME "NAMES" FROM DEPARTMENTS;

--QUESTION #4 Country wise employees highest and avg salary? *

SELECT C.COUNTRY_NAME, MAX(E.SALARY) AS MAX_SALARY_COUNTRYWISE, ROUND(AVG(E.SALARY)) AS AVG_SALARY_COUNTRYWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
GROUP BY C.COUNTRY_NAME;

--QUESTION#5 Display City wise avg salary?
SELECT l.city, ROUND(AVG(E.SALARY)) AS AVG_SALARY_COUNTRYWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
GROUP BY L.CITY;

--QUESTION#6 Display the region wise average, min and max salary? *
SELECT R.REGION_NAME, MIN(E.SALARY) AS MIN_SALARY_REGIONWISE, MAX(E.SALARY) AS MAX_SALARY_REGIONWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
JOIN regions R ON C.REGION_ID = r.region_id
GROUP BY R.REGION_NAME;


--QUESTION#7 Display City wise number of employees in descending order? *
SELECT l.city, COUNT(*) FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
GROUP BY L.CITY ORDER BY COUNT(*) DESC;


--QUESTION#8 Display Region Name, City, Dept Name and hire year for all the employees *
SELECT E.FIRST_NAME, E.LAST_NAME, r.region_name, l.city, d.department_name, TO_CHAR(E.HIRE_DATE,'YYYY') AS HIREYEAR
FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
JOIN REGIONS R ON C.REGION_ID = r.region_id;


--QUESTION#9 Display Job Title, Employee First Name and Department name of employees 
--who joined between 2003 and 2007? *
--Use jobs table for Job Title
SELECT J.JOB_TITLE, E.FIRST_NAME, d.department_name, TO_CHAR(E.HIRE_DATE,'YYYY') AS HIREYEAR
FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN JOBS J ON E.JOB_ID = J.JOB_ID
WHERE TO_CHAR(E.HIRE_DATE,'YYYY') >= 2003 AND TO_CHAR(E.HIRE_DATE,'YYYY') <= 2005;



