Assignment 8
QUESTION #1
--Display the DEPARTMENT_ID, DEPARTMENT Name 
--and highest salary in each department form Employee Table? 

SELECT E.DEPARTMENT_ID, D.DEPARTMENT_NAME, J.MAX_SALARY FROM EMPLOYEES E
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN JOBS J ON E.JOB_ID = J.JOB_ID;


-- QUESTION # 2
SELECT * FROM HR.EMPLOYEES 
WHERE 
TO_CHAR(HIRE_DATE, 'MON-YYYY') >='JAN-2005' AND TO_CHAR(HIRE_DATE, 'MON-YYYY') <='FEB-2007'
AND
DEPARTMENT_ID NOT IN (50,60)
AND
SALARY > 4500;


-- QUESTION#3 Display unique City and department Name? *
SELECT DISTINCT  CITY AS "NAMES" FROM LOCATIONS
UNION
SELECT DISTINCT DEPARTMENT_NAME "NAMES" FROM DEPARTMENTS;

SELECT DISTINCT  CITY AS "NAMES" FROM LOCATIONS;
SELECT DISTINCT DEPARTMENT_NAME "NAMES" FROM DEPARTMENTS;

--QUESTION #4 Country wise employees highest and avg salary? *

SELECT C.COUNTRY_NAME, MAX(E.SALARY) AS MAX_SALARY_COUNTRYWISE, ROUND(AVG(E.SALARY)) AS AVG_SALARY_COUNTRYWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
GROUP BY C.COUNTRY_NAME;

--QUESTION#5 Display City wise avg salary?
SELECT l.city, ROUND(AVG(E.SALARY)) AS AVG_SALARY_COUNTRYWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
GROUP BY L.CITY;

--QUESTION#6 Display the region wise average, min and max salary? *
SELECT R.REGION_NAME, MIN(E.SALARY) AS MIN_SALARY_REGIONWISE, MAX(E.SALARY) AS MAX_SALARY_REGIONWISE FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
JOIN regions R ON C.REGION_ID = r.region_id
GROUP BY R.REGION_NAME;


--QUESTION#7 Display City wise number of employees in descending order? *
SELECT l.city, COUNT(*) FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
GROUP BY L.CITY ORDER BY COUNT(*) DESC;


--QUESTION#8 Display Region Name, City, Dept Name and hire year for all the employees *
SELECT E.FIRST_NAME, E.LAST_NAME, r.region_name, l.city, d.department_name, TO_CHAR(E.HIRE_DATE,'YYYY') AS HIREYEAR
FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN LOCATIONS L ON D.LOCATION_ID = L.LOCATION_ID
JOIN COUNTRIES C ON L.COUNTRY_ID = C.COUNTRY_ID
JOIN REGIONS R ON C.REGION_ID = r.region_id;


--QUESTION#9 Display Job Title, Employee First Name and Department name of employees 
--who joined between 2003 and 2007? *
--Use jobs table for Job Title
SELECT J.JOB_TITLE, E.FIRST_NAME, d.department_name, TO_CHAR(E.HIRE_DATE,'YYYY') AS HIREYEAR
FROM EMPLOYEES E 
JOIN DEPARTMENTS D ON E.DEPARTMENT_ID = D.DEPARTMENT_ID
JOIN JOBS J ON E.JOB_ID = J.JOB_ID
WHERE TO_CHAR(E.HIRE_DATE,'YYYY') >= 2003 AND TO_CHAR(E.HIRE_DATE,'YYYY') <= 2005;

Assignment 2  (03-17-2021,11.30AM)
1--Select all column form Employees who has salary is 4100? *
Select * from hr.employees where salary = 4100;
2--Select all column form Employees who has salary less than 4100? *
Select * from hr.employees where salary >4100;
3--Select all column form Employees who has salary less than or equal to 2800 ? *
Select * from hr.employees where salary <=2800;
4--Select all column form Employees who has salary more than or equal to 2800 ? *
Select * from hr.employees where salary >=2800;
Select * from hr.employees where salary =2800;
5--Select all column form Employees who has salary 2800 and 3800? *
Select * from hr.employees where salary between 2800 and 3800;
6--Select all column form Employees who has job id as 'AD_PRES'. 
Select * from hr.employees where job_id = 'AD_PRES';
7--Select First Name form Employees who has email as 'SBAIDA' *
SELECT FIRST_NAME,EMAIL FROM HR.EMPLOYEES WHERE EMAIL = 'SBAIDA';
8--Select all column form Employees where department_id is 150? *
SELECT * FROM HR.EMPLOYEES WHERE DEPARTMENT_ID = 150;
9--Select all column form Employees where department_id is 40? *
SELECT * FROM HR.EMPLOYEES WHERE DEPARTMENT_ID = 40;
10--Select all Employees from Employees who has salary less than 2000? *
Select * from hr.employees where salary >=2000;
11--Select all Employees from Employees who joined on '17-JUN-03? *
Select * from hr.employees where HIRE_DATE = '17-JUN-2003';
 Inner joins
SELECT
    emp.first_name,
    emp.employee_id as empempid,
    emp.job_id as empjobid,
    j.job_id as jobjobid,
    emp.department_id as empdeparid,
    dept.department_id as deptdepartid,
    dept.location_id as deptlocid,
    loc.location_id as loclocid,
    coun.country_id as concountryid,
    loc.country_id as locconid,
    coun.region_id as conregid,
    reg.region_id as regregid
FROM
         hr.employees emp
    JOIN hr.departments    dept ON emp.department_id = dept.department_id
    JOIN hr.locations      loc ON loc.location_id = dept.location_id
    JOIN hr.countries      coun ON coun.country_id = loc.country_id
    JOIN hr.regions        reg ON reg.region_id = coun.region_id
    JOIN hr.jobs           j ON j.job_id = emp.job_id;

106 similar records displayed from above 6 tables inner join.

SELECT
    emp.first_name,
    emp.employee_id as empempid,
    emp.job_id as empjobid,
    j.job_id as jobjobid,
    emp.department_id as empdeparid,
    dept.department_id as deptdepartid,
    dept.location_id as deptlocid,
    loc.location_id as loclocid,
    coun.country_id as concountryid,
    loc.country_id as locconid,
    coun.region_id as conregid,
    reg.region_id as regregid
FROM
         hr.employees emp
    JOIN hr.departments    dept ON emp.department_id = dept.department_id
    JOIN hr.locations      loc ON loc.location_id = dept.location_id
    JOIN hr.countries      coun ON coun.country_id = loc.country_id
    JOIN hr.regions        reg ON reg.region_id = coun.region_id
    JOIN hr.jobs           j ON j.job_id = emp.job_id
    join hr.job_history jh  on emp.employee_id = jh.employee_id

when we inner join the "Job_history" table with above 6 tables,displad only 10 records.

 SELECT
    emp.first_name,
    emp.employee_id    AS empempid,
    emp.job_id         AS empjobid,
    j.job_id           AS jobjobid

FROM
         hr.employees emp
    JOIN hr.jobs j ON j.job_id = emp.job_id ;
 
when we inner join the employees and jobs tables 107 records are displayed (107 from emp. and 

SELECT
    emp.first_name,
    emp.employee_id       AS empempid,
    emp.department_id     AS edeptid,
    dept.department_id    AS d_departmentid
FROM
         hr.employees emp
    JOIN hr.departments dept ON emp.department_id = dept.department_id ;
  
106 records displayed ( 106 from emp("Kimberely"-employee_id-178 is not included)

left joins
 SELECT
    emp.first_name,
    emp.employee_id    AS empempid,
    emp.job_id         AS empjobid,
    j.job_id           AS jobjobid

FROM
         hr.employees emp
     left JOIN hr.jobs j ON j.job_id = emp.job_id ;
107 records(similor records from emp.107 and 

SELECT
    emp.first_name,
    emp.employee_id       AS empempid,
    emp.department_id     AS edeptid,
    dept.department_id    AS d_departmentid
FROM
         hr.employees emp
left JOIN hr.departments dept ON emp.department_id = dept.department_id;    107 records

right joins

 SELECT
    emp.first_name,
    emp.employee_id    AS empempid,
    emp.job_id         AS empjobid,
    j.job_id           AS jobjobid

FROM
         hr.employees emp
    right JOIN hr.jobs j ON j.job_id = emp.job_id ;

107 records(similor records from emp.107 and 

SELECT
    emp.first_name,
    emp.employee_id       AS empempid,
    emp.department_id     AS edeptid,
    dept.department_id    AS d_departmentid
FROM
         hr.employees emp
right JOIN hr.departments dept ON emp.department_id = dept.department_id;

total 122 records(from employees table 106 related/similor department_id,11 records from dept tablerelated/similor department_id and from right table = dept table all total 27(27-11=16+106=122)


>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

Assignment 12( 04-05-2021 : 2:50 pm)

--1.Display Emp id, Emp First Name who does NOT work in department 'Sales' ? *
SELECT
    emp.employee_id,
    dept.department_name,
    emp.first_name
from hr.employees emp
join hr.departments dept
on emp.department_id = dept.department_id
where department_name !='Sales'
--where  department_name  not in ('Sales')
--where department_name <>'Sales'

--2.Display Employee details who department name 
--is 'Shipping' and MIN_SALARY range is 3000 to 5000 ? *
SELECT
   emp.first_name,
    dept.department_name,
    j.min_salary    
from hr.employees emp
join hr.departments dept
on emp.department_id = dept.department_id
join hr.jobs j
on emp.job_id = j.job_id
where department_name ='Shipping' and min_salary between 3000 and 5000;


--3.Display Employee details who department name IS NOT 'IT' 
--AND Salary range between 5000 to 9000 and his city is NOT 'Seattle' ? *

select emp.first_name,emp.salary,dept.department_name,loc.city
from hr.employees emp
join hr.departments dept
on emp.department_id = dept.department_id
join hr.locations loc
on dept.location_id = loc.location_id
where   department_name != 'IT'  and city !='Seattle' and salary between '5000' and '9000'


--4.Display employee and department name name in which he is not in either 
--'Sales Representative' or 'Purchasing Manager.? *
select emp.first_name,dept.department_name,j.job_title
from hr.employees emp
join hr.departments dept
on emp.department_id = dept.department_id
join hr.jobs j
on emp.job_id = j.job_id
where job_title not in ('Sales Representative', 'Purchasing Manager')

--5.Display first name and experience of the employees? *
select first_name|| ' '|| last_name as Fullname,
trunc(months_between(sysdate, hire_date)/12) as TotalYearsExperience
from hr.employees;
Select first_name||' '|| last_name as FullName,
round(Months_between(sysdate, hire_date)/12) as TotalYearExperience
from hr.employees;

--6.Display Employees who joined after 2005 and joined in month of March? *
select * from hr.employees
where to_char(hire_date, 'yyyy')>'2005' and to_char(hire_date, 'mon')='mar'

--7.Display Emp id, Emp First Name, Manager id and Manager First Name? *
--Use Self join
SELECT
    emp.employee_id,
    emp.first_name,
    manager.employee_id as "managerempid",   
    manager.first_name  as "managerfirstname"  
FROM
         hr.employees emp
JOIN hr.employees manager 
ON emp.manager_id = manager.employee_id
    
--8.Display Emp id, Emp First Name who has more salary than their Manager? *
--Use Self join
SELECT
    emp.employee_id,
    emp.first_name,
    emp.salary,
    manager.first_name as managerfirstname,
    manager.salary as managersalary
from hr.employees emp
join hr.employees manager
on emp.manager_id = manager.employee_id
where emp.salary > manager.salary 
--9.Display Emp id, Emp First Name who has joined before their Manager? *
select emp.employee_id,
        emp.first_name,
        emp.hire_date,
manager.first_name    as "managerfirstname",
manager.hire_date      as "managerhiredate"
 from hr.employees emp
 join hr.employees manager
 on emp.manager_id = manager.employee_id
 where emp.hire_date <manager.hire_date
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

qUERIES RUN (DATED 04-07-2021 11:45PM)
SELECT
    employee_id,
    first_name,
    last_name,
    email,
    phone_number,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id = 30
union

SELECT
    employee_id,
    first_name,
    last_name,
    email,
    phone_number,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id IN ( 10, 20 )
    

SELECT
    employee_id,
    first_name,
    NULL AS middle_name,
    last_name,
    email,
    phone_number,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id = 30
union
SELECT
    employee_id,
    first_name,
    'Ram' AS middle_name,
    last_name,
    email,
    phone_number,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id IN ( 10, 20 )
    

   
SELECT
    employee_id,
    first_name,
    last_name,
    email,
    phone_number AS homephone,
    '3343434344' mobile_phone,
    hire_date,
    commission_pct,
    manager_id,
    department_id
FROM
    hr.employees
WHERE
    department_id IN ( 40, 70 )
    
   

SELECT
    employee_id,
    first_name,
    NULL  AS middle_name,
    last_name,
    email,
    phone_number,
    NULL  AS mobile_number,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id = 30

UNION

SELECT
    employee_id,
    first_name,
    'Ram'  AS middle_name,
    last_name,
    email,
    phone_number,
    NULL   AS mobile_phone,
    hire_date,
    commission_pct,
    department_id
FROM
    hr.employees
WHERE
    department_id IN ( 10, 20,30)  

UNION  
SELECT
    employee_id,
    first_name,
    'krishna'     AS middle_name,
    last_name,
    email,
    phone_number  AS homephone,
    '3343434344'  mobile_phone,
    hire_date,
    NULL          AS commission_pct,
    department_id
from hr.employees 
where department_id in (30,40,70)

SELECT
    employee_id, first_name, NULL as Middle_Name, last_name, email, phone_number,NULL as Mobile_Phone, hire_date,
commission_pct,department_id
FROM
    hr.employees where department_id = 30
UNION 
SELECT
    employee_id, first_name, 'Ram' as Middle_Name, last_name, email, phone_number, NULL as  Mobile_Phone, hire_date,
    commission_pct, department_id
FROM
    hr.employees where department_id in (10,20,30)
UNION 
SELECT
    employee_id, first_name first_nm, 'Krishna' as Middle_Name, last_name, email, phone_number as Home_Phone,
    '334 343 4344' Mobile_Phone, hire_date, NULL as commission_pct, department_id
FROM
    hr.employees where department_id in (30,40,70);



SELECT
    employee_id, first_name, last_name, email, phone_number, hire_date,
commission_pct,department_id
FROM
    hr.employees where department_id = 30
UNION 
SELECT
    employee_id, first_name, last_name, email, phone_number, hire_date,
    commission_pct, department_id
FROM
    hr.employees where department_id in (10,20,30)
UNION 
SELECT
    employee_id, first_name, last_name, email, phone_number as Home_Phone,
     hire_date, NULL as commission_pct, department_id
FROM
    hr.employees where department_id in (30,40,70);
    
    
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary
FROM
    hr.employees where department_id = 30
minus
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary
FROM
    hr.employees where department_id in (10,20,30)
UNION
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary
FROM
    hr.employees where department_id in (30,40,70);
    
    
SELECT
    employee_id, first_name, 'null' as middlename,last_name, email, phone_number, hire_date,job_id,salary,department_id

FROM
    hr.employees where department_id = 30
UNION 
SELECT
    employee_id, first_name, 'null' as middlename,last_name, email, phone_number, hire_date,job_id,salary,department_id
FROM
    hr.employees where department_id in (10,20,30)
UNION 
SELECT
   employee_id, first_name, 'null' as middlename,last_name, email, phone_number, hire_date,job_id,salary,department_id
FROM
    hr.employees where department_id in (30,40,70);


SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in(10,30)
INTERSECT
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (10,20,30)
INTERSECT
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (10,40,70);
    

SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (10,20,30)
MINUS
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (50,60,70);

SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (30,40,70)
MINUS
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (10,20,30);
    
SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (30,40,50,60)
MINUS
 SELECT
employee_id,     first_name,     last_name,     email,     phone_number,     hire_date,     job_id,     salary, department_id
FROM
    hr.employees where department_id in (10,20,30,50,60);

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>